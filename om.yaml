ci:
  default:
    ROOT:
      dir: .
      steps:
        lockfile:
          enable: false
        build:
          enable: false
        flake-check:
          enable: false
      caches:
        required:
          # nixos cache server
          - https://cache.nixos.org
          # nix community's cache server
          - https://nix-community.cachix.org
          # cachix's cache server
          - https://cachix.cachix.org
          # nixpkgs cache server
          - https://nixpkgs.cachix.org
          # omnix cachix binaries
          - https://om.cachix.org
          # determinate binaries
          - https://install.determinate.systems
          # hyprland cachix binaries
          - https://hyprland.cachix.org
          # personal cachix binaries
          - https://saberzero1.cachix.org
  build:
    ROOT:
      dir: .
      steps:
        lockfile:
          enable: false
        build:
          enable: true
          impure: true
        flake-check:
          enable: false
      caches:
        required:
          # nixos cache server
          - https://cache.nixos.org
          # nix community's cache server
          - https://nix-community.cachix.org
          # cachix's cache server
          - https://cachix.cachix.org
          # nixpkgs cache server
          - https://nixpkgs.cachix.org
          # omnix cachix binaries
          - https://om.cachix.org
          # determinate binaries
          - https://install.determinate.systems
          # hyprland cachix binaries
          - https://hyprland.cachix.org
          # personal cachix binaries
          - https://saberzero1.cachix.org
  check:
    ROOT:
      dir: .
      steps:
        lockfile:
          enable: false
        build:
          enable: false
        flake-check:
          enable: true
  update:
    ROOT:
      dir: .
      steps:
        lockfile:
          enable: false
        build:
          enable: false
        flake-check:
          enable: false
        custom:
          update-flake:
            type: devshell
            command:
              - nix
              - flake
              - update
              - --accept-flake-config
  switch:
    ROOT:
      dir: .
      steps:
        lockfile:
          enable: false
        build:
          enable: true
          impure: true
        flake-check:
          enable: false
        custom:
          activate-configuration:
            type: app
            name: activate
          reload-aerospace:
            type: devshell
            command:
              - aerospace
              - reload-config
            systems:
              - aarch64-darwin
          reload-sketchybar:
            type: devshell
            command:
              - sketchybar
              - --reload
            systems:
              - aarch64-darwin
      caches:
        required:
          # nixos cache server
          - https://cache.nixos.org
          # nix community's cache server
          - https://nix-community.cachix.org
          # cachix's cache server
          - https://cachix.cachix.org
          # nixpkgs cache server
          - https://nixpkgs.cachix.org
          # omnix cachix binaries
          - https://om.cachix.org
          # determinate binaries
          - https://install.determinate.systems
          # hyprland cachix binaries
          - https://hyprland.cachix.org
          # personal cachix binaries
          - https://saberzero1.cachix.org
  clean:
    ROOT:
      dir: .
      steps:
        lockfile:
          enable: false
        build:
          enable: false
        flake-check:
          enable: false
        custom:
          collect-garbage:
            type: devshell
            command:
              - sudo
              - nix-collect-garbage
              - -d
          optimise-store:
            type: devshell
            command:
              - sudo
              - nix
              - store
              - optimise
          switch-to-configuration:
            type: devshell
            command:
              - sudo
              - /run/current-system/bin/switch-to-configuration
              - boot
            systems:
              - x86_64-linux
              - aarch64-linux
health:
  default:
    nix-version:
      supported: ">=2.16.0"
    caches:
      required:
        # nixos cache server
        - https://cache.nixos.org
        # nix community's cache server
        - https://nix-community.cachix.org
        # cachix's cache server
        - https://cachix.cachix.org
        # nixpkgs cache server
        - https://nixpkgs.cachix.org
        # omnix cachix binaries
        - https://om.cachix.org
        # determinate binaries
        - https://install.determinate.systems
        # hyprland cachix binaries
        - https://hyprland.cachix.org
        # personal cachix binaries
        - https://saberzero1.cachix.org
    direnv:
      required: true
  build:
    nix-version:
      supported: ">=2.16.0"
    caches:
      required:
        # nixos cache server
        - https://cache.nixos.org
        # nix community's cache server
        - https://nix-community.cachix.org
        # cachix's cache server
        - https://cachix.cachix.org
        # nixpkgs cache server
        - https://nixpkgs.cachix.org
        # omnix cachix binaries
        - https://om.cachix.org
        # determinate binaries
        - https://install.determinate.systems
        # hyprland cachix binaries
        - https://hyprland.cachix.org
        # personal cachix binaries
        - https://saberzero1.cachix.org
    direnv:
      required: true
  check:
    nix-version:
      supported: ">=2.16.0"
    caches:
      required:
        # nixos cache server
        - https://cache.nixos.org
        # nix community's cache server
        - https://nix-community.cachix.org
        # cachix's cache server
        - https://cachix.cachix.org
        # nixpkgs cache server
        - https://nixpkgs.cachix.org
        # omnix cachix binaries
        - https://om.cachix.org
        # determinate binaries
        - https://install.determinate.systems
        # hyprland cachix binaries
        - https://hyprland.cachix.org
        # personal cachix binaries
        - https://saberzero1.cachix.org
    direnv:
      required: true
  clean:
    nix-version:
      supported: ">=2.16.0"
    caches:
      required:
        # nixos cache server
        - https://cache.nixos.org
        # nix community's cache server
        - https://nix-community.cachix.org
        # cachix's cache server
        - https://cachix.cachix.org
        # nixpkgs cache server
        - https://nixpkgs.cachix.org
        # omnix cachix binaries
        - https://om.cachix.org
        # determinate binaries
        - https://install.determinate.systems
        # hyprland cachix binaries
        - https://hyprland.cachix.org
        # personal cachix binaries
        - https://saberzero1.cachix.org
    direnv:
      required: true
  update:
    nix-version:
      supported: ">=2.16.0"
    caches:
      required:
        # nixos cache server
        - https://cache.nixos.org
        # nix community's cache server
        - https://nix-community.cachix.org
        # cachix's cache server
        - https://cachix.cachix.org
        # nixpkgs cache server
        - https://nixpkgs.cachix.org
        # omnix cachix binaries
        - https://om.cachix.org
        # determinate binaries
        - https://install.determinate.systems
        # hyprland cachix binaries
        - https://hyprland.cachix.org
        # personal cachix binaries
        - https://saberzero1.cachix.org
    direnv:
      required: true
  switch:
    nix-version:
      supported: ">=2.16.0"
    caches:
      required:
        # nixos cache server
        - https://cache.nixos.org
        # nix community's cache server
        - https://nix-community.cachix.org
        # cachix's cache server
        - https://cachix.cachix.org
        # nixpkgs cache server
        - https://nixpkgs.cachix.org
        # omnix cachix binaries
        - https://om.cachix.org
        # determinate binaries
        - https://install.determinate.systems
        # hyprland cachix binaries
        - https://hyprland.cachix.org
        # personal cachix binaries
        - https://saberzero1.cachix.org
    direnv:
      required: true
